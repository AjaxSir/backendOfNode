import{z as M,aP as Z,s as x,w as ee,Y as se,aR as ae,ar as le,B as r,D as d,E as t,N as _,O as c,H as e,at as n,aa as p,au as N,av as S,a9 as G,a8 as b,P as te,aU as w,aV as B,aQ as A,aW as F,ac as oe,an as ne,aX as re,aY as de,b0 as ie,b1 as ue,b2 as ce,b3 as pe,b5 as me}from"../index.js";import{u as _e,h as fe,j as ve,T as E,l as W,E as be,r as he}from"./hookOfFlash.js";/* empty css    */const m=V=>(ie("data-v-fe8d56a1"),V=V(),ue(),V),Ve={class:"trans-ways"},ye={class:"header"},Ie={class:"config trans-channel"},Pe={class:"title"},ge={class:"cont"},Ne={key:0},we=m(()=>t("span",{class:"required"},"*",-1)),ke=m(()=>t("br",null,null,-1)),Se=["src"],Ge={key:1},Be=m(()=>t("span",{class:"required"},"*",-1)),Ae=m(()=>t("br",null,null,-1)),We={key:1},Ce=m(()=>t("span",{class:"required"},"*",-1)),Te=m(()=>t("br",null,null,-1)),Ue=["src"],xe={key:1},Fe={key:2,class:"ip"},Ee=m(()=>t("span",null,[t("span",{class:"required"},"*"),_(" IP")],-1)),Re=m(()=>t("br",null,null,-1)),De=["src"],Le={key:1},Oe={key:3},qe=m(()=>t("span",{class:"required"},"*",-1)),ze=m(()=>t("br",null,null,-1)),$e={key:4},Qe=m(()=>t("br",null,null,-1)),Ye={key:5},je=m(()=>t("br",null,null,-1)),Je=M({__name:"getVersion",emits:["changeFlashing"],setup(V,{emit:R}){const{isSerialPortRefresh:D,serialPortList:k,getSerialPort:C,maxWidth:L}=_e(),{getGetVersionInfo:O,saveGetVersionInfo:q}=ce,{isDeviceRefresh:z,deviceList:T,getDeviceList:U}=fe(),{isIPTesting:$,testIp:Q}=ve(),{t:o}=Z(),Y=R;let s=x({GetWay:0,PortInfo:{PortName:"",UserName:"root",Password:""},deviceNumber:"",IpAddress:"",AdbPassword:"x1#y23z",SubBoardName:"",SOCType:1});const u=x(!1),j=ee(()=>{let i=!1;const{IpAddress:l,deviceNumber:f,AdbPassword:v}=s.value;switch(s.value.GetWay){case 0:const{PortName:y}=s.value.PortInfo;i=!!y;break;case 1:i=!!(f&&v);break;default:i=!!(l&&v);break}return i}),J=(i=!1)=>{U(i).then(()=>{s.value.deviceNumber=""})},H=(i=!1)=>{C(i).then(()=>{let l=!1;k.value.forEach(f=>{f.Value==s.value.PortInfo.PortName&&(l=!0)}),s.value.PortInfo.PortName=l?s.value.PortInfo.PortName:""})},X=()=>{Q(s.value)},K=()=>{w.open(o("getVerison.get_version_ing")),u.value=!0,q(JSON.stringify({getVersionInfo:s.value})),B.send({functionId:A.Protobuf.BSTFlashInterface.GetVersionInfo,data:s.value}).then(i=>{F.success(`${i.SystemVersion}`,o("getVerison.version_info"),o("common.confirm"),"")}).finally(()=>{w.close(),u.value=!1}).catch(()=>{})};return se(u,(i,l)=>{Y("changeFlashing",i)}),ae(async()=>{pe.on("RestartBoardR",()=>{w.close(),F.info(o("getVerison.please_reset_board"),o("common.tips"),o("common.confirm"),o("common.cancel")).then(()=>{w.open(o("getVerison.get_version_ing")),B.send({functionId:A.Protobuf.BSTFlashInterface.RestartBoard,data:{IsReset:!0}})}).catch(()=>{B.send({functionId:A.Protobuf.BSTFlashInterface.RestartBoard,data:{IsReset:!1}}),u.value=!1})});const i=await O(),l=JSON.parse(i);if(s.value=l?l.getVersionInfo:s.value,s.value.GetWay==0){await C();const f=k.value.map(v=>v.Value);console.log(s.value,"getGetVersionInfo"),f.includes(s.value.PortInfo.PortName)||(s.value.PortInfo.PortName="")}else s.value.GetWay==1&&(await U(!0),T.value.map(v=>v.Value).includes(s.value.deviceNumber)||(s.value.deviceNumber=""))}),(i,l)=>{const f=le("QuestionFilled"),v=oe,y=ne,h=be,I=he,P=re,g=de;return r(),d(N,null,[t("div",Ve,[t("span",null,[_(c(e(o)("getVerison.trans_way"))+" ",1),n(y,{class:"box-item",effect:"dark","raw-content":"","show-arrow":!1,content:e(E).map(a=>a.description).join("<br />"),placement:"top-start"},{default:p(()=>[n(v,{size:"20"},{default:p(()=>[n(f)]),_:1})]),_:1},8,["content"])]),t("div",ye,[n(I,{"popper-class":"select-class",modelValue:e(s).GetWay,"onUpdate:modelValue":l[0]||(l[0]=a=>e(s).GetWay=a),placeholder:e(o)("common.please_select")},{default:p(()=>[(r(!0),d(N,null,S(e(E),a=>(r(),G(h,{key:a.value,label:a.name,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),n(P,{onClick:K,class:"start-flash get-version-btn",disabled:!j.value},{default:p(()=>[_(c(e(o)("getVerison.get_version")),1)]),_:1},8,["disabled"])])]),t("div",Ie,[t("div",Pe,c(e(o)("common.transport_channel")),1),t("div",ge,[e(s).GetWay===1?(r(),d("div",Ne,[t("span",null,[we,_(" "+c(e(o)("common.devide_number")),1)]),ke,n(P,{onClick:l[1]||(l[1]=a=>J(!1)),disabled:u.value,type:"primary",class:"refresh"},{default:p(()=>[e(z)?(r(),d("img",{key:0,src:e(W),alt:"",srcset:""},null,8,Se)):(r(),d("span",Ge,c(e(o)("common.refresh")),1))]),_:1},8,["disabled"]),n(I,{class:"device",disabled:u.value,"popper-class":"select-class",modelValue:e(s).deviceNumber,"onUpdate:modelValue":l[2]||(l[2]=a=>e(s).deviceNumber=a),placeholder:e(o)("common.please_select")},{default:p(()=>[(r(!0),d(N,null,S(e(T),a=>(r(),G(h,{key:a.Value,label:a.Name,value:a.Value},null,8,["label","value"]))),128))]),_:1},8,["disabled","modelValue","placeholder"])])):b("",!0),t("div",null,[t("span",null,[Be,_(" "+c(e(o)("getVerison.board_type")),1)]),_(),Ae,n(I,{class:"device",disabled:u.value,"popper-class":"select-class",modelValue:e(s).SOCType,"onUpdate:modelValue":l[3]||(l[3]=a=>e(s).SOCType=a),placeholder:e(o)("common.please_select")},{default:p(()=>[n(h,{label:"A1000B",value:1}),n(h,{label:"C1200",value:2})]),_:1},8,["disabled","modelValue","placeholder"])]),e(s).GetWay===0?(r(),d("div",We,[t("span",null,[Ce,_(" "+c(e(o)("common.serial_port")),1)]),_(),Te,n(P,{onClick:l[4]||(l[4]=a=>H(!0)),disabled:u.value,type:"primary",class:"refresh"},{default:p(()=>[e(D)?(r(),d("img",{key:0,src:e(W),alt:"",srcset:""},null,8,Ue)):(r(),d("span",xe,c(e(o)("common.refresh")),1))]),_:1},8,["disabled"]),n(I,{class:"port",style:te({width:e(L)}),"popper-class":"select-class",modelValue:e(s).PortInfo.PortName,"onUpdate:modelValue":l[5]||(l[5]=a=>e(s).PortInfo.PortName=a),disabled:u.value,placeholder:e(o)("common.please_select")},{default:p(()=>[(r(!0),d(N,null,S(e(k),a=>(r(),G(h,{disabled:!!a.Disabled,key:a.Value,label:a.Name,value:a.Value},null,8,["disabled","label","value"]))),128))]),_:1},8,["style","modelValue","disabled","placeholder"])])):b("",!0),e(s).GetWay===2?(r(),d("div",Fe,[Ee,_(),Re,n(P,{disabled:u.value,type:"primary",onClick:X,class:"refresh"},{default:p(()=>[e($)?(r(),d("img",{key:0,src:e(W),alt:"",srcset:""},null,8,De)):(r(),d("span",Le,c(e(o)("common.test")),1))]),_:1},8,["disabled"]),n(g,{disabled:u.value,modelValue:e(s).IpAddress,"onUpdate:modelValue":l[6]||(l[6]=a=>e(s).IpAddress=a)},null,8,["disabled","modelValue"])])):b("",!0),[1,2].includes(e(s).GetWay)?(r(),d("div",Oe,[t("span",null,[qe,_(" "+c(e(o)("common.ADB_password"))+" ",1),n(y,{class:"box-item",effect:"dark","raw-content":"","show-arrow":!1,content:e(o)("common.adb_tips"),placement:"top-start"},{default:p(()=>[n(v,{size:"20"},{default:p(()=>[n(f)]),_:1})]),_:1},8,["content"])]),_(),ze,n(g,{disabled:u.value,type:"password",modelValue:e(s).AdbPassword,"onUpdate:modelValue":l[7]||(l[7]=a=>e(s).AdbPassword=a)},null,8,["disabled","modelValue"])])):b("",!0),e(s).GetWay===0?(r(),d("div",$e,[t("span",null,c(e(o)("common.username")),1),Qe,n(g,{disabled:u.value,modelValue:e(s).PortInfo.UserName,"onUpdate:modelValue":l[8]||(l[8]=a=>e(s).PortInfo.UserName=a)},null,8,["disabled","modelValue"])])):b("",!0),e(s).GetWay===0?(r(),d("div",Ye,[t("span",null,c(e(o)("common.password")),1),je,n(g,{type:"password",disabled:u.value,modelValue:e(s).PortInfo.Password,"onUpdate:modelValue":l[9]||(l[9]=a=>e(s).PortInfo.Password=a)},null,8,["disabled","modelValue"])])):b("",!0)])])],64)}}});const Me=me(Je,[["__scopeId","data-v-fe8d56a1"]]);export{Me as default};
